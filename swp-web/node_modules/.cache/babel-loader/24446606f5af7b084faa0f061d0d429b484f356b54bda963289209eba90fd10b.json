{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nexport default {\n  name: 'AppPicture',\n  data() {\n    return {\n      name: '',\n      password: '',\n      picture: '',\n      NAME: '',\n      BALANCE: '',\n      USERID: '',\n      PASSWORD: '',\n      pictureid: '',\n      picturename: '',\n      pictureprice: '',\n      picturecreatid: '',\n      picturesrc: ''\n    };\n  },\n  mounted() {\n    // 在组件加载时自动执行的函数\n    this.NAME = sessionStorage.getItem('NAME');\n    this.USERID = sessionStorage.getItem('USERID');\n    this.BALANCE = sessionStorage.getItem('BALANCE');\n    this.PASSWORD = sessionStorage.getItem('PASSWORD');\n    this.pictureid = this.$route.query.wpid;\n    this.picturesrc = this.$route.query.name;\n    sessionStorage.setItem('SEARCHTYPE', '');\n    console.log(this.NAME);\n    console.log(this.USERID);\n    console.log(this.PASSWORD);\n    console.log(this.BALANCE);\n    console.log(this.$route.query.name);\n    console.log(this.$route.query.wpid);\n    console.log(this.picturesrc);\n    this.postImagePrice();\n  },\n  methods: {\n    downloadImg(imgsrc, name) {\n      console.log(this.picturesrc);\n      var image = new Image();\n      // 解决跨域 Canvas 污染问题\n      image.setAttribute(\"crossOrigin\", \"anonymous\");\n      image.onload = function () {\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = image.width;\n        canvas.height = image.height;\n        var context = canvas.getContext(\"2d\");\n        context.drawImage(image, 0, 0, image.width, image.height);\n        var url = canvas.toDataURL(); //得到图片的base64编码数据\n        var a = document.createElement(\"a\"); // 生成一个a元素\n        var event = new MouseEvent(\"click\"); // 创建一个单击事件\n        a.download = name || \"photo\"; // 设置图片名称\n        a.href = url; // 将生成的URL设置为a.href属性\n        a.dispatchEvent(event); // 触发a的单击事件\n      };\n\n      image.src = imgsrc;\n    },\n    loadpicture() {\n      let user = {\n        vwpId: this.pictureid,\n        orderId: '',\n        buyerId: this.USERID\n      };\n      // if(this.BALANCE<this.pictureprice)\n      // {\n      //   alert(\"抱歉，您无法购买此壁纸，因为您的余额不足\");\n      //   location.reload();\n      // }\n      // if(this.USERID==this.picturecreatid)\n      // {\n      //   alert(\"抱歉，您无法购买此壁纸，因为您是壁纸的上传者\");\n      //   location.reload();\n      // }\n      let self = this;\n      this.$axios.post('http://localhost:8090/vwporder/download', user) ////////////////////////////////////登录信息\n      .then(function (response) {\n        let result = response.data;\n        if (result.code === 200) {\n          console.log(\"登录成功！\");\n          console.log(\"返回的数据：\", result.data);\n          console.log(\"总记录数：\", result.total);\n          location.reload();\n        } else if (result.code === 400) {\n          console.log(\"失败！\");\n          alert(\"您无法购买此壁纸，因为你是此壁纸的上传者，或者您的余额不足\");\n          location.reload();\n        }\n      }).catch(function (error) {\n        console.log(\"请求错误：\", error);\n      });\n    },\n    touser() {\n      let self = this;\n      self.$router.push(\"/user\");\n    },\n    toindex() {\n      let self = this;\n      self.$router.push(\"/index\");\n    },\n    toupload() {\n      this.$router.push(\"/upload\");\n    },\n    async postImagePrice() {\n      let vwallpaper = {\n        vwpId: this.pictureid,\n        name: '',\n        createId: '',\n        price: '',\n        type: '',\n        path: ''\n      };\n      try {\n        //使用axios发送一个GET请求，假设后端有一个接口可以返回图片的文件名\n        let response = await axios.post(\"http://localhost:8090/vwallpaper/getImagesByVwpid\", vwallpaper);\n        //如果请求成功，将文件名保存到imageName属性中\n        if (response.status === 200) {\n          console.log(response.data);\n          console.log(this.imageName);\n          this.picturename = response.data.data[0].name;\n          this.picturecreatid = response.data.data[0].createId;\n          this.pictureprice = response.data.data[0].price;\n        }\n      } catch (error) {\n        //如果请求失败，打印错误信息\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","password","picture","NAME","BALANCE","USERID","PASSWORD","pictureid","picturename","pictureprice","picturecreatid","picturesrc","mounted","sessionStorage","getItem","$route","query","wpid","setItem","console","log","postImagePrice","methods","downloadImg","imgsrc","image","Image","setAttribute","onload","canvas","document","createElement","width","height","context","getContext","drawImage","url","toDataURL","a","event","MouseEvent","download","href","dispatchEvent","src","loadpicture","user","vwpId","orderId","buyerId","self","$axios","post","then","response","result","code","total","location","reload","alert","catch","error","touser","$router","push","toindex","toupload","vwallpaper","createId","price","type","path","status","imageName"],"sources":["src/components/AppPicture.vue"],"sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div class=\"header\">\r\n            <div class=\"logo\">壁纸引擎--壁纸</div>\r\n            <div class=\"nav\">\r\n                <button @click=\"toindex\">首页</button>\r\n                <button>分类</button>\r\n                <button @click=\"toupload\">上传</button>\r\n                <div class=\"userimgbox\">\r\n                    <img src=\"../assets/tou1.jpg\" alt=\"\" width=\"25\" @click=\"touser\">\r\n                    <div>{{ this.NAME }}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"nav\">\r\n            <button @click=\"toindex\"> 《--返回上一页</button>\r\n        </div>\r\n        <div class=\"info\">\r\n            <div>壁纸名称: {{this.picturename}}</div>\r\n            <div>壁纸价格: {{this.pictureprice}}￥</div>\r\n            <div>壁纸创作者: {{this.picturecreatid}}</div>\r\n            <button @click=\"loadpicture\">下载</button>\r\n            <button @click=\"downloadImg('this.picturesrc','hhhh')\">下载12</button>\r\n        </div>\r\n        <div class=\"image\">\r\n            <img v-if=\"this.$route.query.name\" :src=\"this.$route.query.name\">\r\n        </div>\r\n        <div class=\"footer\">\r\n            <p>© 2023 壁纸引擎. All rights reserved.</p>\r\n        </div>\r\n    </div>\r\n</template>\r\n    \r\n<script>\r\n\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n    name: 'AppPicture',\r\n    data() {\r\n        return {\r\n            name: '',\r\n            password: '',\r\n            picture: '',\r\n            NAME:'',\r\n            BALANCE:'',\r\n            USERID:'',\r\n            PASSWORD:'',\r\n            pictureid:'',\r\n            picturename:'',\r\n            pictureprice:'',\r\n            picturecreatid:'',\r\n            picturesrc:'',\r\n        }\r\n    },\r\n    mounted() {\r\n      // 在组件加载时自动执行的函数\r\n      this.NAME=sessionStorage.getItem('NAME')\r\n      this.USERID=sessionStorage.getItem('USERID')\r\n      this.BALANCE=sessionStorage.getItem('BALANCE')\r\n      this.PASSWORD=sessionStorage.getItem('PASSWORD')\r\n      this.pictureid=this.$route.query.wpid;\r\n      this.picturesrc=this.$route.query.name;\r\n      sessionStorage.setItem('SEARCHTYPE', '')\r\n      console.log(this.NAME)\r\n      console.log(this.USERID)\r\n      console.log(this.PASSWORD)\r\n      console.log(this.BALANCE)\r\n      console.log(this.$route.query.name)\r\n      console.log(this.$route.query.wpid)\r\n      console.log(this.picturesrc)\r\n\r\n      this.postImagePrice();\r\n    },\r\n    methods: {\r\n      downloadImg(imgsrc, name) {\r\n        console.log(this.picturesrc);\r\n        var image = new Image();\r\n        // 解决跨域 Canvas 污染问题\r\n        image.setAttribute(\"crossOrigin\", \"anonymous\");\r\n        image.onload = function () {\r\n          var canvas = document.createElement(\"canvas\");\r\n          canvas.width = image.width;\r\n          canvas.height = image.height;\r\n          var context = canvas.getContext(\"2d\");\r\n          context.drawImage(image, 0, 0, image.width, image.height);\r\n          var url = canvas.toDataURL(); //得到图片的base64编码数据\r\n          var a = document.createElement(\"a\"); // 生成一个a元素\r\n          var event = new MouseEvent(\"click\"); // 创建一个单击事件\r\n          a.download = name || \"photo\"; // 设置图片名称\r\n          a.href = url; // 将生成的URL设置为a.href属性\r\n          a.dispatchEvent(event); // 触发a的单击事件\r\n        };\r\n        image.src = imgsrc;\r\n      },\r\n      loadpicture(){\r\n        let user = {\r\n          vwpId: this.pictureid,\r\n          orderId:'',\r\n          buyerId:this.USERID,\r\n        };\r\n        // if(this.BALANCE<this.pictureprice)\r\n        // {\r\n        //   alert(\"抱歉，您无法购买此壁纸，因为您的余额不足\");\r\n        //   location.reload();\r\n        // }\r\n        // if(this.USERID==this.picturecreatid)\r\n        // {\r\n        //   alert(\"抱歉，您无法购买此壁纸，因为您是壁纸的上传者\");\r\n        //   location.reload();\r\n        // }\r\n        let self = this;\r\n        this.$axios.post('http://localhost:8090/vwporder/download', user)     ////////////////////////////////////登录信息\r\n            .then(function (response) {\r\n              let result = response.data;\r\n              if (result.code === 200) {\r\n                console.log(\"登录成功！\");\r\n                console.log(\"返回的数据：\", result.data);\r\n                console.log(\"总记录数：\", result.total);\r\n\r\n                location.reload();\r\n              } else if (result.code === 400) {\r\n                console.log(\"失败！\");\r\n                alert(\"您无法购买此壁纸，因为你是此壁纸的上传者，或者您的余额不足\");\r\n                location.reload();\r\n              }\r\n            })\r\n            .catch(function (error) {\r\n              console.log(\"请求错误：\", error);\r\n            });\r\n\r\n      },\r\n        touser() {\r\n            let self = this;\r\n            self.$router.push(\"/user\");\r\n        },\r\n        toindex() {\r\n            let self = this;\r\n            self.$router.push(\"/index\");\r\n        },\r\n        toupload() {\r\n            this.$router.push(\"/upload\");\r\n        },\r\n        async postImagePrice() {\r\n        let vwallpaper = {\r\n\r\n          vwpId:this.pictureid ,\r\n          name:'',\r\n          createId:'',\r\n          price:'',\r\n          type:'',\r\n          path:''\r\n\r\n        };\r\n        try {\r\n          //使用axios发送一个GET请求，假设后端有一个接口可以返回图片的文件名\r\n          let response = await axios.post(\"http://localhost:8090/vwallpaper/getImagesByVwpid\",vwallpaper);\r\n          //如果请求成功，将文件名保存到imageName属性中\r\n          if (response.status === 200) {\r\n            console.log(response.data);\r\n            console.log(this.imageName);\r\n            this.picturename=response.data.data[0].name;\r\n            this.picturecreatid=response.data.data[0].createId;\r\n            this.pictureprice=response.data.data[0].price;\r\n\r\n          }\r\n        } catch (error) {\r\n          //如果请求失败，打印错误信息\r\n          console.error(error);\r\n        }\r\n      },\r\n    }\r\n}\r\n\r\n</script>\r\n    \r\n<style scoped>\r\nbody {\r\n    background-color: #f0f0f0;\r\n    font-family: Arial, sans-serif;\r\n}\r\n\r\n.container {\r\n    width: 80%;\r\n    margin: 0 auto;\r\n}\r\n\r\n.header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 20px;\r\n}\r\n\r\n.logo {\r\n    font-size: 32px;\r\n    font-weight: bold;\r\n    color: #333333;\r\n}\r\n\r\n.nav {\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.nav img:hover {\r\n  cursor: pointer;\r\n}\r\n\r\n.nav button {\r\n  text-decoration: none;\r\n  color: #333333;\r\n  font-size: 16px;\r\n  border: none;\r\n  background-color: rgba(255, 255, 255, 0);\r\n}\r\n\r\n.nav button:hover {\r\n  color: #0099ff;\r\n  cursor: pointer;\r\n}\r\n\r\n.back {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    margin-top: 20px;\r\n}\r\n\r\n.back a {\r\n    text-decoration: none;\r\n    color: #333333;\r\n    font-size: 16px;\r\n}\r\n\r\n.back a:hover {\r\n    color: #0099ff;\r\n}\r\n\r\n.image {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-top: 20px;\r\n}\r\n\r\n.image img {\r\n    width: 80%;\r\n    height: auto;\r\n}\r\n\r\n.info {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    margin-top: 20px;\r\n    margin-left: 90px;\r\n\r\n  gap: 20px;\r\n  width: 1000px;\r\n  height: 100px;\r\n  margin-right: 10px;\r\n  object-fit: cover;\r\n  border-top: 1px solid rgba(255, 255, 255, 0.5);\r\n  /* 在盒子的顶部添加一个1像素宽的边框，颜色为白色，透明度为50%。 */\r\n  border-left: 1px solid rgba(255, 255, 255, 0.5);\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.3);\r\n  border-right: 1px solid rgba(255, 255, 255, 0.3);\r\n  backdrop-filter: blur(10px);\r\n  /* 对盒子应用一个模糊半透明的效果，模糊半径为10像素。这样可以创建玻璃模糊的效果，模糊盒子后面的内容。 */\r\n  background: rgba(50, 50, 50, 0.2);\r\n  /* 设置盒子的背景颜色为半透明的深灰色（RGB值为50, 50, 50），透明度为20%。 */\r\n\r\n  /* 设置盒子使用Flexbox布局。 */\r\n  /* 将Flex容器的主轴方向设置为垂直，使得项目在列方向上排列。 */\r\n  justify-content: center;\r\n  /*  在盒子的垂直方向上居中内容。 */\r\n  align-items: center;\r\n  /* 在盒子的水平方向上居中内容。 */\r\n  border-radius: 10px;\r\n  /* 应用一个10像素的圆角，使得盒子的角变得圆滑。 */\r\n}\r\n\r\n.info p {\r\n    font-size: 16px;\r\n    color: #333333;\r\n}\r\n\r\n.info button {\r\n    width: 100px;\r\n    height: 40px;\r\n    border: none;\r\n    border-radius: 20px;\r\n    background-color: #0099ff;\r\n    color: white;\r\n    font-size: 16px;\r\n}\r\n.info button:hover {\r\n    background-color: #0066cc;\r\n    cursor: pointer;\r\n}\r\n\r\n.footer {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 20px;\r\n}\r\n\r\n.footer p {\r\n    font-size: 14px;\r\n    color: #999999;\r\n}\r\n\r\n.userimgbox {\r\n    margin-top: 20px;\r\n}\r\n</style>\r\n    \r\n    "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}